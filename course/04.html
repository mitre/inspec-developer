<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.45" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mitre.github.io/inspec-developer/course/04.html"><meta property="og:site_name" content="SAF InSpec Profile Developer"><meta property="og:title" content="Exploring the InSpec Shell"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-05-24T01:31:48.000Z"><meta property="og:locale" content="en-US"><meta property="article:author" content="Aaron Lippold"><meta property="article:modified_time" content="2022-05-24T01:31:48.000Z"><title>Exploring the InSpec Shell | SAF InSpec Profile Developer</title><meta name="description" content="The MITRE Security Automation Framework Team's Introduction to InSpec profile development">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/inspec-developer/assets/style.1ef00196.css">
    <link rel="modulepreload" href="/inspec-developer/assets/app.ceb64e6c.js"><link rel="modulepreload" href="/inspec-developer/assets/04.html.07617e0a.js"><link rel="modulepreload" href="/inspec-developer/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/inspec-developer/assets/04.html.1c5b0849.js"><link rel="prefetch" href="/inspec-developer/assets/LICENSE.html.7ca46f83.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.7a702236.js"><link rel="prefetch" href="/inspec-developer/assets/intro.html.db1b76ba.js"><link rel="prefetch" href="/inspec-developer/assets/slide.html.f0c39f17.js"><link rel="prefetch" href="/inspec-developer/assets/02.html.878266d0.js"><link rel="prefetch" href="/inspec-developer/assets/03.html.17ee902d.js"><link rel="prefetch" href="/inspec-developer/assets/05.html.88ea5e26.js"><link rel="prefetch" href="/inspec-developer/assets/06.html.caf241a5.js"><link rel="prefetch" href="/inspec-developer/assets/07.html.d12ad4f6.js"><link rel="prefetch" href="/inspec-developer/assets/08.html.a9f2d726.js"><link rel="prefetch" href="/inspec-developer/assets/09.html.ba131fb8.js"><link rel="prefetch" href="/inspec-developer/assets/10.html.f72d6ae3.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.72a40039.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.d41e7e23.js"><link rel="prefetch" href="/inspec-developer/assets/disable.html.8c460c08.js"><link rel="prefetch" href="/inspec-developer/assets/encrypt.html.d10188b4.js"><link rel="prefetch" href="/inspec-developer/assets/markdown.html.920c341c.js"><link rel="prefetch" href="/inspec-developer/assets/page.html.c696f7a3.js"><link rel="prefetch" href="/inspec-developer/assets/LinuxInstall.html.1130e34c.js"><link rel="prefetch" href="/inspec-developer/assets/MacInstall.html.8dc7e10d.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.f6c0a458.js"><link rel="prefetch" href="/inspec-developer/assets/WindowsInstall.html.ff8cea08.js"><link rel="prefetch" href="/inspec-developer/assets/article10.html.092c3b16.js"><link rel="prefetch" href="/inspec-developer/assets/article11.html.2f4a597d.js"><link rel="prefetch" href="/inspec-developer/assets/article12.html.322366a7.js"><link rel="prefetch" href="/inspec-developer/assets/article9.html.1e120e1f.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.d76ab8a6.js"><link rel="prefetch" href="/inspec-developer/assets/article1.html.b52428d2.js"><link rel="prefetch" href="/inspec-developer/assets/article2.html.03f6dc05.js"><link rel="prefetch" href="/inspec-developer/assets/article3.html.f7ebcafa.js"><link rel="prefetch" href="/inspec-developer/assets/article4.html.be12a1ca.js"><link rel="prefetch" href="/inspec-developer/assets/article5.html.10e69526.js"><link rel="prefetch" href="/inspec-developer/assets/article6.html.f62c613c.js"><link rel="prefetch" href="/inspec-developer/assets/article7.html.39eae80c.js"><link rel="prefetch" href="/inspec-developer/assets/article8.html.e782e80f.js"><link rel="prefetch" href="/inspec-developer/assets/404.html.bbc3d075.js"><link rel="prefetch" href="/inspec-developer/assets/LICENSE.html.0ad9182a.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.4c66c058.js"><link rel="prefetch" href="/inspec-developer/assets/intro.html.fae7b1ef.js"><link rel="prefetch" href="/inspec-developer/assets/slide.html.a3eb748d.js"><link rel="prefetch" href="/inspec-developer/assets/02.html.df2ca2e1.js"><link rel="prefetch" href="/inspec-developer/assets/03.html.f4bb367c.js"><link rel="prefetch" href="/inspec-developer/assets/05.html.10332e89.js"><link rel="prefetch" href="/inspec-developer/assets/06.html.69e59f09.js"><link rel="prefetch" href="/inspec-developer/assets/07.html.da101341.js"><link rel="prefetch" href="/inspec-developer/assets/08.html.00f13c80.js"><link rel="prefetch" href="/inspec-developer/assets/09.html.21cc77e4.js"><link rel="prefetch" href="/inspec-developer/assets/10.html.da8f529d.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.8a70d552.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.e9da36ea.js"><link rel="prefetch" href="/inspec-developer/assets/disable.html.d848e521.js"><link rel="prefetch" href="/inspec-developer/assets/encrypt.html.dc7385fc.js"><link rel="prefetch" href="/inspec-developer/assets/markdown.html.cff16c4a.js"><link rel="prefetch" href="/inspec-developer/assets/page.html.d9ea83f5.js"><link rel="prefetch" href="/inspec-developer/assets/LinuxInstall.html.fcb711a8.js"><link rel="prefetch" href="/inspec-developer/assets/MacInstall.html.ef1bb4d5.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.4d99c7df.js"><link rel="prefetch" href="/inspec-developer/assets/WindowsInstall.html.c9be9eb3.js"><link rel="prefetch" href="/inspec-developer/assets/article10.html.f62986ce.js"><link rel="prefetch" href="/inspec-developer/assets/article11.html.ca1aeb4d.js"><link rel="prefetch" href="/inspec-developer/assets/article12.html.60188812.js"><link rel="prefetch" href="/inspec-developer/assets/article9.html.714f2740.js"><link rel="prefetch" href="/inspec-developer/assets/index.html.71ab380a.js"><link rel="prefetch" href="/inspec-developer/assets/article1.html.717227e7.js"><link rel="prefetch" href="/inspec-developer/assets/article2.html.1b15e657.js"><link rel="prefetch" href="/inspec-developer/assets/article3.html.cb5373eb.js"><link rel="prefetch" href="/inspec-developer/assets/article4.html.5ea01373.js"><link rel="prefetch" href="/inspec-developer/assets/article5.html.545b72b9.js"><link rel="prefetch" href="/inspec-developer/assets/article6.html.2833b057.js"><link rel="prefetch" href="/inspec-developer/assets/article7.html.d7995efe.js"><link rel="prefetch" href="/inspec-developer/assets/article8.html.cae8e131.js"><link rel="prefetch" href="/inspec-developer/assets/404.html.1d55c70a.js"><link rel="prefetch" href="/inspec-developer/assets/404.f68424bb.js"><link rel="prefetch" href="/inspec-developer/assets/Layout.11df10c8.js"><link rel="prefetch" href="/inspec-developer/assets/Slide.58362e4a.js"><link rel="prefetch" href="/inspec-developer/assets/giscus.es.10e3969d.js"><link rel="prefetch" href="/inspec-developer/assets/auto.esm.15d52109.js"><link rel="prefetch" href="/inspec-developer/assets/index.308e684a.js"><link rel="prefetch" href="/inspec-developer/assets/index.1842ee54.js"><link rel="prefetch" href="/inspec-developer/assets/mermaid.esm.min.95aabeb7.js"><link rel="prefetch" href="/inspec-developer/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/inspec-developer/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/inspec-developer/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/inspec-developer/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/inspec-developer/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/inspec-developer/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/inspec-developer/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/inspec-developer/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/inspec-developer/" class="home-link"><img class="logo" src="/inspec-developer/logo.svg" alt="SAF InSpec Profile Developer"><!----><span class="site-name hide-in-pad">SAF InSpec Profile Developer</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/inspec-developer/" class="nav-link" aria-label="MITRE InSpec Profile Developer Course"><span class="icon iconfont icon-home" style=""></span>MITRE InSpec Profile Developer Course<!----></a></div><div class="nav-item hide-in-mobile"><a href="/inspec-developer/course/" class="nav-link active" aria-label="Course"><span class="icon iconfont icon-creative" style=""></span>Course<!----></a></div><div class="nav-item hide-in-mobile"><a href="/inspec-developer/resources/" class="nav-link" aria-label="Resources"><span class="icon iconfont icon-note" style=""></span>Resources<!----></a></div><div class="nav-item hide-in-mobile"><a href="/inspec-developer/installation/" class="nav-link" aria-label="Installation"><span class="icon iconfont icon-note" style=""></span>Installation<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/mitre/inspec-developer" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading clickable active"><span class="icon iconfont icon-creative" style=""></span><a href="/inspec-developer/course/" class="title">Course</a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/inspec-developer/course/" class="nav-link sidebar-link sidebar-page" aria-label="Course Overview"><span class="icon iconfont icon-page" style=""></span>Course Overview<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/02.html" class="nav-link sidebar-link sidebar-page" aria-label="Starting the Journey"><span class="icon iconfont icon-page" style=""></span>Starting the Journey<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/03.html" class="nav-link sidebar-link sidebar-page" aria-label="Studying an InSpec Profile"><span class="icon iconfont icon-page" style=""></span>Studying an InSpec Profile<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/inspec-developer/course/04.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Exploring the InSpec Shell"><span class="icon iconfont icon-page" style=""></span>Exploring the InSpec Shell<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/inspec-developer/course/04.html#exploring-the-inspec-shell" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Exploring the InSpec Shell"><!---->Exploring the InSpec Shell<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/inspec-developer/course/04.html#entering-the-inspec-shell" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Entering the InSpec shell"><!---->Entering the InSpec shell<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/inspec-developer/course/04.html#exploring-the-file-resource" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Exploring the file resource"><!---->Exploring the file resource<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/inspec-developer/course/04.html#explore-the-nginx-resource" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Explore The nginx Resource"><!---->Explore The nginx Resource<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/05.html" class="nav-link sidebar-link sidebar-page" aria-label="Writing InSpec Controls"><span class="icon iconfont icon-page" style=""></span>Writing InSpec Controls<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/06.html" class="nav-link sidebar-link sidebar-page" aria-label="Generating InSpec Results"><span class="icon iconfont icon-page" style=""></span>Generating InSpec Results<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/07.html" class="nav-link sidebar-link sidebar-page" aria-label="Viewing and Analyzing Results"><span class="icon iconfont icon-page" style=""></span>Viewing and Analyzing Results<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/08.html" class="nav-link sidebar-link sidebar-page" aria-label="InSpec Examples"><span class="icon iconfont icon-page" style=""></span>InSpec Examples<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/09.html" class="nav-link sidebar-link sidebar-page" aria-label="Profile Inheritance &amp; Overlays"><span class="icon iconfont icon-page" style=""></span>Profile Inheritance &amp; Overlays<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/inspec-developer/course/10.html" class="nav-link sidebar-link sidebar-page" aria-label="From STIG to Profile"><span class="icon iconfont icon-page" style=""></span>From STIG to Profile<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-page" style=""></span>Exploring the InSpec Shell</h1><div class="page-info"><!----><span class="date-info" aria-label="Writing Date📅" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>May 22, 2022</span><meta property="datePublished" content="2022-05-22T22:43:36.000Z"></span><!----><!----><span class="reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 6 min</span><meta property="timeRequired" content="PT6M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/inspec-developer/course/04.html#exploring-the-inspec-shell" class="router-link-active router-link-exact-active toc-link level2">Exploring the InSpec Shell</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/inspec-developer/course/04.html#entering-the-inspec-shell" class="router-link-active router-link-exact-active toc-link level3">Entering the InSpec shell</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/inspec-developer/course/04.html#exploring-the-file-resource" class="router-link-active router-link-exact-active toc-link level3">Exploring the file resource</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/inspec-developer/course/04.html#explore-the-nginx-resource" class="router-link-active router-link-exact-active toc-link level3">Explore The nginx Resource</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><h2 id="exploring-the-inspec-shell" tabindex="-1"><a class="header-anchor" href="#exploring-the-inspec-shell" aria-hidden="true">#</a> Exploring the InSpec Shell</h2><p>Before we test our NGINX configuration, let&#39;s plan which resources and matchers we&#39;ll need.</p><p>When writing InSpec code, many resources are available to you.</p><ul><li>You can <a href="https://www.inspec.io/docs/" target="_blank" rel="noopener noreferrer">explore the InSpec documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to see which resources and matchers are available.</li><li>You can <a href="https://github.com/inspec/inspec" target="_blank" rel="noopener noreferrer">examine the source code<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to see what&#39;s available. For example, you can see how file and other InSpec resources are implemented.</li><li>You can also use examples, such as profiles provided on <a href="https://supermarket.chef.io/tools-directory" target="_blank" rel="noopener noreferrer">Chef Supermarket<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, as a guide.</li></ul><p>There&#39;s also <a href="https://www.inspec.io/docs/reference/shell/" target="_blank" rel="noopener noreferrer">InSpec shell<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, which enables you to explore InSpec interactively. In this part, you&#39;ll use the InSpec shell to discover which resources you can use to test your NGINX configuration.</p><p>You&#39;re not required to use InSpec shell to develop your profiles. Some users find the InSpec shell to be a useful way to get immediate feedback and explore what&#39;s available. You can also use InSpec shell to debug your profiles.</p><h3 id="entering-the-inspec-shell" tabindex="-1"><a class="header-anchor" href="#entering-the-inspec-shell" aria-hidden="true">#</a> Entering the InSpec shell</h3><p>Run <code>inspec shell</code> to enter the interactive session.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>inspec shell
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Which should drop you into the shell, like this:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Welcome to the interactive InSpec Shell
To find out how to use it, type: help

You are currently running on:

    Name:      ubuntu
    Families:  debian, linux, unix
    Release:   16.04
    Arch:      x86_64
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Run <code>help</code> to see what commands are available.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">help</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Which should return something like:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>
inspec<span class="token operator">&gt;</span> <span class="token builtin class-name">help</span>
    You are currently running on:

        Name:      ubuntu
        Families:  debian, linux, unix
        Release:   <span class="token number">16.04</span>
        Arch:      x86_64

    Available commands:

        <span class="token variable"><span class="token variable">`</span><span class="token punctuation">[</span>resource<span class="token punctuation">]</span><span class="token variable">`</span></span> - run resource on target machine
        <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">help</span> resources<span class="token variable">`</span></span> - show all available resources that can be used as commands
        <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">help</span> <span class="token punctuation">[</span>resource<span class="token punctuation">]</span><span class="token variable">`</span></span> - information about a specific resource
        <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">help</span> matchers<span class="token variable">`</span></span> - show information about common matchers
        <span class="token variable"><span class="token variable">`</span><span class="token builtin class-name">exit</span><span class="token variable">`</span></span> - <span class="token builtin class-name">exit</span> the InSpec shell

    You can use resources <span class="token keyword">in</span> this environment to <span class="token builtin class-name">test</span> the target machine.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Run <code>help resources</code> to see which resources are available.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">help</span> resources
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Which will return a list like:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>inspec<span class="token operator">&gt;</span> <span class="token builtin class-name">help</span> resources

         - aide_conf
         - apache
         - apache_conf
         - <span class="token function">apt</span>
         - audit_policy
         - auditd
         - auditd_conf
         <span class="token punctuation">..</span>.
         - <span class="token function">file</span>
         <span class="token punctuation">..</span>.
         - xml
         - yaml
         - yum
         - yumrepo
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You see <code>file</code> and other resources listed.</p><h3 id="exploring-the-file-resource" tabindex="-1"><a class="header-anchor" href="#exploring-the-file-resource" aria-hidden="true">#</a> Exploring the <code>file</code> resource</h3><p>Earlier, we saw this <code>describe</code> block:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/tmp&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should be_directory <span class="token punctuation">}</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Let&#39;s run a few commands from the InSpec shell to see how the <code>file</code> resource functions.</p><div class="custom-container tip"><p class="custom-container-title">What is the difference between InSpec and Ruby?</p><p>Inspec is a Domain Specific Language (DSL) on top of Ruby. In other words, InSpec is built on the Ruby programming language. For example, InSpec matchers are implemented as Ruby methods.</p></div><p>Run this command to list which methods are available to the <code>file</code> resource.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/tmp&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span>superclass<span class="token punctuation">.</span>instance_methods<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Which will give you the following output:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>inspec<span class="token operator">&gt;</span> file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/tmp&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span>superclass<span class="token punctuation">.</span>instance_methods<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort

        <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token symbol">:allowed?</span><span class="token punctuation">,</span>
         <span class="token symbol">:basename</span><span class="token punctuation">,</span>
         <span class="token symbol">:block_device?</span><span class="token punctuation">,</span>
         <span class="token symbol">:character_device?</span><span class="token punctuation">,</span>
         <span class="token symbol">:contain</span><span class="token punctuation">,</span>
         <span class="token symbol">:content</span><span class="token punctuation">,</span>
         <span class="token symbol">:directory?</span><span class="token punctuation">,</span>
         <span class="token operator">...</span>
         <span class="token symbol">:sticky</span><span class="token punctuation">,</span>
         <span class="token symbol">:sticky?</span><span class="token punctuation">,</span>
         <span class="token symbol">:suid</span><span class="token punctuation">,</span>
         <span class="token symbol">:symlink?</span><span class="token punctuation">,</span>
         <span class="token symbol">:to_s</span><span class="token punctuation">,</span>
         <span class="token symbol">:type</span><span class="token punctuation">,</span>
         <span class="token symbol">:uid</span><span class="token punctuation">,</span>
         <span class="token symbol">:version?</span><span class="token punctuation">,</span>
         <span class="token symbol">:writable?</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can use the arrow or Page Up and Page Down keys to scroll through the list. When you&#39;re done, press <code>Q</code>.</p><div class="custom-container tip"><p class="custom-container-title">What is the InSpec Shell?</p><p>InSpec shell is based on a tool called <code>pry</code>. <code>pry</code> is an interactive debugging environment for ruby and is one of the ruby developer&#39;s weapons against bugs.</p></div><p>Let&#39;s use the InSpec shell to explore some resources in InSpec. We will start with one of the most common elements on the system: a directory.</p><p>In the InSpec Shell call the <code>file.directory?</code> method.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>file<span class="token punctuation">(</span><span class="token string">&#39;/tmp&#39;</span><span class="token punctuation">)</span>.directory?
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>This will return <code>true</code>, since <code>/tmp</code> is a directory on the system.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>inspec<span class="token operator">&gt;</span> file<span class="token punctuation">(</span><span class="token string">&#39;/tmp&#39;</span><span class="token punctuation">)</span>.directory?
        <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token boolean">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>You can see that the <code>/tmp</code> directory exists on your workstation container.</p><p>To make the tests easier to read, the InSpec language uses &quot;syntactic sugar&quot; to turn methods into English-like phrases. For example, the Ruby language contains boolean methods ending in <code>?</code> which evaluate to <code>true</code> or <code>false</code> (<code>nil</code> is a type of false). InSpec changes the syntax of these methods to include <code>be_</code> before the method rather than <code>?</code> after the method to make it more readable. For example, to check if a directory exists, Ruby would traditionally use <code>directory?</code> while InSpec uses <code>be_directory</code>.</p><div class="custom-container info"><p class="custom-container-title">Using Ruby Predicate Methods</p><p>Given what we have just learned, the <strong>best practice</strong> in InSpec is to return something that evaluates to <code>true</code> or <code>false</code>. The <code>?</code> (or <code>be_</code> in InSpec) makes your method a Ruby Predicate Method. See <a href="http://ruby-for-beginners.rubymonstas.org/objects/predicates.html" target="_blank" rel="noopener noreferrer">Ruby predicate methods<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> to learn more.</p></div><p>The InSpec shell understands the structure of blocks. This enables you to run mutiline code. As an example, run the entire <code>describe</code> block like this.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>describe file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/tmp&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
  it <span class="token punctuation">{</span> should be_directory <span class="token punctuation">}</span>
<span class="token keyword">end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Which will run the entire block of code in the InSpec Shell and return the result.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>inspec<span class="token operator">&gt;</span> describe file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/tmp&#39;</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
inspec<span class="token operator">&gt;</span>  it <span class="token punctuation">{</span> should be_directory <span class="token punctuation">}</span>
inspec<span class="token operator">&gt;</span> <span class="token keyword">end</span>

<span class="token symbol">Profile</span><span class="token operator">:</span> inspec<span class="token operator">-</span>shell
<span class="token symbol">Version</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">not</span> specified<span class="token punctuation">)</span>

<span class="token builtin">File</span> <span class="token operator">/</span>tmp
  ✔  should be directory

Test Summary<span class="token operator">:</span> <span class="token number">1</span> successful<span class="token punctuation">,</span> <span class="token number">0</span> failures<span class="token punctuation">,</span> <span class="token number">0</span> skipped
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In practice, you don&#39;t typically run controls interactively this way for day to day use, but it is a great way to test out your ideas, find bugs or validate your approach before running a scan in its entirety on a target of evaluation.</p><h3 id="explore-the-nginx-resource" tabindex="-1"><a class="header-anchor" href="#explore-the-nginx-resource" aria-hidden="true">#</a> Explore The nginx Resource</h3><p>Now&#39;s a good time to define the requirements for our NGINX configuration. Let&#39;s say that you require:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">1</span>. NGINX version <span class="token number">1.10</span>.3 or later.
<span class="token number">2</span>. The following NGINX modules should be installed:
   * <span class="token variable"><span class="token variable">`</span>http_ssl<span class="token variable">`</span></span>
   * <span class="token variable"><span class="token variable">`</span>stream_ssl<span class="token variable">`</span></span>
   * <span class="token variable"><span class="token variable">`</span>mail_ssl<span class="token variable">`</span></span>
<span class="token number">3</span>. The NGINX configuration <span class="token function">file</span> - <span class="token variable"><span class="token variable">`</span>/etc/nginx/nginx.conf<span class="token variable">`</span></span>- should:
   * be owned by the <span class="token variable"><span class="token variable">`</span>root<span class="token variable">`</span></span> user and group.
   * not be readable, writeable, or executable by others.

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Let&#39;s see what resources are available to help define these requirements as InSpec controls.</p><p>Run <code>help resources</code> a second time.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">help</span> resources
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Notice InSpec provides two built-in resources to support NGINX – <code>nginx</code> and <code>nginx_conf</code>.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>inspec<span class="token operator">&gt;</span> <span class="token builtin class-name">help</span> resources

         - aide_conf
         - apache
         - apache_conf
         - <span class="token function">apt</span>
         <span class="token punctuation">..</span>.
         - nginx
         - nginx_conf
         <span class="token punctuation">..</span>.
         - xml
         - yaml
         - yum
         - yumrepo
         - zfs_dataset
         - zfs_pool
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Run <code>nginx.methods</code>.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>nginx<span class="token punctuation">.</span>methods
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You can see the <code>version</code> and <code>modules</code> methods.</p><p>You will use these methods to define the first two requirements.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>inspec<span class="token operator">&gt;</span> nginx<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span>superclass<span class="token punctuation">.</span>instance_methods<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort

        <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token symbol">:bin_dir</span><span class="token punctuation">,</span>
         <span class="token symbol">:compiler_info</span><span class="token punctuation">,</span>
         <span class="token symbol">:error_log_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:http_client_body_temp_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:http_fastcgi_temp_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:http_log_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:http_proxy_temp_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:http_scgi_temp_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:http_uwsgi_temp_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:lock_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:modules</span><span class="token punctuation">,</span>
         <span class="token symbol">:modules_path</span><span class="token punctuation">,</span>
         <span class="token symbol">:openssl_version</span><span class="token punctuation">,</span>
         <span class="token operator">...</span>
         <span class="token symbol">:to_s</span><span class="token punctuation">,</span>
         <span class="token symbol">:version</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Run <code>nginx.version</code> to see what result you get.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>nginx<span class="token punctuation">.</span>version
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">Expected Error Ahead</p><p>Recall that you&#39;re working on your workstation environment, which does not have NGINX installed.</p></div><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>inspec<span class="token operator">&gt;</span> nginx<span class="token punctuation">.</span>version

        <span class="token symbol">NoMethodError</span><span class="token operator">:</span> undefined method `<span class="token punctuation">[</span><span class="token punctuation">]</span>&#39; <span class="token keyword">for</span> <span class="token keyword">nil</span><span class="token symbol">:NilClass</span>
        from <span class="token operator">/</span>opt<span class="token operator">/</span>inspec<span class="token operator">/</span>embedded<span class="token operator">/</span>lib<span class="token operator">/</span>ruby<span class="token operator">/</span>gems<span class="token operator">/</span><span class="token number">2.4</span><span class="token number">.0</span><span class="token operator">/</span>gems<span class="token operator">/</span>inspec<span class="token operator">-</span><span class="token number">2.0</span><span class="token number">.17</span><span class="token operator">/</span>lib<span class="token regex-literal"><span class="token regex">/resources/nginx</span></span><span class="token punctuation">.</span>rb<span class="token operator">:</span><span class="token number">39</span><span class="token symbol">:in</span> `block <span class="token punctuation">(</span><span class="token number">2</span> levels<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span><span class="token keyword">class</span><span class="token symbol">:Nginx</span><span class="token operator">&gt;</span>&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We can verify this with Inspec by running the following command:</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>package<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;nginx&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>installed<span class="token operator">?</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>As you can see we get <code>false</code> - since nginx is not installed on your <code>runner</code>.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>inspec<span class="token operator">&gt;</span> package<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;nginx&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>installed<span class="token operator">?</span>

        <span class="token operator">=&gt;</span> <span class="token boolean">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now that we have explored and discovered the resource methods we need – <code>version</code> and <code>modules</code> – let&#39;s run InSpec shell commands against the target that does have NGINX installed to see what results we find.</p><p>To do so, first start by exiting your InSpec shell session.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>inspec&gt; exit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Run <code>inspec shell</code> a second time and this time, provide the <code>-t</code> argument to connect the shell session to the target container.</p><p>First let&#39;s find our nginx container id using the <code>docker ps</code> command:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">ps</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Which will return something like:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>➜  course git:<span class="token punctuation">(</span>master<span class="token punctuation">)</span> ✗ <span class="token function">docker</span> <span class="token function">ps</span>
CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS          PORTS                NAMES
d4bcef5bb9e3   nginx:latest   <span class="token string">&quot;/docker-entrypoint.…&quot;</span>   <span class="token number">23</span> seconds ago   Up <span class="token number">22</span> seconds   <span class="token number">80</span>/tcp               nifty_shtern
4f0ceb9b5974   nginx:latest   <span class="token string">&quot;/docker-entrypoint.…&quot;</span>   <span class="token number">2</span> months ago     Up <span class="token number">45</span> seconds   <span class="token number">0.0</span>.0.0:80-<span class="token operator">&gt;</span><span class="token number">80</span>/tcp   nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We can then use the container id of our nginx container to target the inspec shell at that container.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>inspec shell -t docker://CONTAINER_ID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>InSpec will then return at the Shell Prompt as before but this time we see we are on our container.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Welcome to the interactive InSpec Shell
To <span class="token function">find</span> out how to use it, type: <span class="token builtin class-name">help</span>

You are currently running on:

    Name:      debian
    Families:  debian, linux, unix, os
    Release:   <span class="token number">11.2</span>
    Arch:      aarch64

inspec<span class="token operator">&gt;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Remember that the target does not have InSpec installed on it. Your shell session exists on the workstation; InSpec routes commands to the target instance over Docker.</p><p>Run the <code>package</code> resource a second time, this time on the target container.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>package<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;nginx&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>installed<span class="token operator">?</span>&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>As you can see, how the InSpec <code>package</code> resources returns <code>true</code>.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>inspec&gt; package(&#39;nginx&#39;).installed?

        =&gt; true
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, let&#39;s get the <code>version</code> of NGINX that is installed on the target, run: <code>nginx.version</code></p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>nginx<span class="token punctuation">.</span>version
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You can see that version 1.10.3 was installed on our container.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>inspec&gt; nginx.version

        =&gt; &quot;1.10.3&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To complete the example, let&#39;s see which <code>modules</code> are enabled on the nginx container. Run <code>nginx.modules</code> to list the installed NGINX modules.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>nginx<span class="token punctuation">.</span>modules
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You see below - and hopefully on the data you got back on your container - that the required modules, <code>http_ssl</code>, <code>stream_ssl</code>, and <code>mail_ssl</code>, are installed.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>inspec<span class="token operator">&gt;</span> nginx<span class="token punctuation">.</span>modules

        <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">&quot;http_ssl&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_stub_status&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_realip&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_auth_request&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_addition&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_dav&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_geoip&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_gunzip&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_gzip_static&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_image_filter&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_v2&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_sub&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;http_xslt&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;stream_ssl&quot;</span></span><span class="token punctuation">,</span>
         <span class="token string-literal"><span class="token string">&quot;mail_ssl&quot;</span></span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <a href="https://www.inspec.io/docs/reference/resources/nginx_conf/" target="_blank" rel="noopener noreferrer">nginx_conf<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> resource examines the contents of the NGINX configuration file, <code>/etc/nginx/nginx.conf</code>.</p><p>Recall that the third requirement is to check whether the NGINX configuration file is owned by <code>root</code> and is not readable, writeable, or executable by others. Because we want to test attributes of the file itself, and not its contents, you&#39;ll use the <code>file</code> resource.</p><p>You saw earlier how the <code>file</code> resource provides the <code>readable</code>, <code>writeable</code>, and <code>executable</code> methods. You would also see that the <code>file</code> resource provides the <code>owned_by</code> and <code>grouped_into</code> methods.</p><div class="language-ruby ext-rb line-numbers-mode"><pre class="language-ruby"><code>inspec<span class="token operator">&gt;</span> file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">&#39;/tmp&#39;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span>superclass<span class="token punctuation">.</span>instance_methods<span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort

        <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token symbol">:allowed?</span><span class="token punctuation">,</span>
         <span class="token symbol">:directory?</span><span class="token punctuation">,</span>
         <span class="token symbol">:executable?</span><span class="token punctuation">,</span>
         <span class="token symbol">:exist?</span><span class="token punctuation">,</span>
         <span class="token symbol">:file</span><span class="token punctuation">,</span>
         <span class="token symbol">:file?</span><span class="token punctuation">,</span>
         <span class="token symbol">:file_version</span><span class="token punctuation">,</span>
         <span class="token symbol">:gid</span><span class="token punctuation">,</span>
         <span class="token symbol">:group</span><span class="token punctuation">,</span>
         <span class="token symbol">:grouped_into?</span><span class="token punctuation">,</span>
         <span class="token operator">...</span>
         <span class="token symbol">:owned_by?</span><span class="token punctuation">,</span>
         <span class="token operator">...</span>
         <span class="token symbol">:readable?</span><span class="token punctuation">,</span>
         <span class="token operator">...</span>
         <span class="token symbol">:to_s</span><span class="token punctuation">,</span>
         <span class="token symbol">:type</span><span class="token punctuation">,</span>
         <span class="token symbol">:uid</span><span class="token punctuation">,</span>
         <span class="token symbol">:version?</span><span class="token punctuation">,</span>
         <span class="token symbol">:writable?</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>These 5 <code>file</code> methods – <code>grouped_into</code>, <code>executable</code>, <code>owned_by</code>, <code>readable</code> and <code>writeable</code> – provide everything we need for the third requirement.</p><p>Exit the InSpec shell session with the <code>exit</code> command.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>inspec<span class="token operator">&gt;</span> <span class="token builtin class-name">exit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/mitre/inspec-developer/edit/main/course/04.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">Last update: </span><span class="info">5/24/2022, 1:31:48 AM</span></div><div class="meta-item contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: lippold@gmail.com">Aaron Lippold</span>,<!--]--><!--[--><span class="contributor" title="email: 32680215+em-c-rod@users.noreply.github.com">Emily Rodriguez</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/inspec-developer/course/03.html" class="nav-link prev" aria-label="Studying an InSpec Profile"><div class="hint"><span class="arrow left"></span>Prev</div><div class="link"><span class="icon iconfont icon-page" style=""></span>Studying an InSpec Profile</div></a><a href="/inspec-developer/course/05.html" class="nav-link next" aria-label="Writing InSpec Controls"><div class="hint">Next<span class="arrow right"></span></div><div class="link">Writing InSpec Controls<span class="icon iconfont icon-page" style=""></span></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Apache-2.0 | Copyright © 2022 - The MITRE Corporation</div><div class="copyright">Copyright © 2022 Aaron Lippold</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/inspec-developer/assets/app.ceb64e6c.js" defer></script>
  </body>
</html>
